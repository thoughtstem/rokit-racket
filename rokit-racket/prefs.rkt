#lang racket

(provide prefs
         write-out-prefs)

(define (write-out-prefs file (rokit-path "/Users/thoughtstem/Downloads/rokitarduinov1-0-9")
                              (serial-port "cu.usbserial-AI046LB6"))
  (define s (prefs->string (prefs rokit-path serial-port)))
  (displayln s)
  (with-output-to-file file #:exists 'replace
    (lambda () (printf s))))

(define (pref->string p)
  (format "~a=~a" (first p)
                  (if (= 2 (length p))
                      (second p)
                      "")))

(define (prefs->string ps)
  (string-join (map pref->string ps) "\n"))

(define (prefs (rokit-path "/Users/thoughtstem/Downloads/rokitarduinov1-0-9")
               (serial-port "cu.usbserial-AI046LB6"))

  (define /dev/serial-port (string-append "/dev/" serial-port))
  
  `((board SmartInventor-mega32_v2)
    (boardsmanager.additional.urls )
    (build.verbose false)
    (build.warn_data_percentage 75)
    (compiler.cache_core true)
    (compiler.warning_level none)
    (console true)
    (console.auto_clear true)
    (console.error.file stderr.txt)
    (console.length 500)
    (console.lines 4)
    (console.output.file stdout.txt)
    (editor.antialias true)
    (editor.auto_close_braces true)
    (editor.caret.blink true)
    (editor.code_folding false)
    (editor.divider.size 0)
    (editor.external false)
    (editor.font "Monaco,plain,12")
    (editor.indent true)
    (editor.invalid false)
    (editor.keys.alternative_cut_copy_paste false)
    (editor.keys.home_and_end_beginning_end_of_doc false)
    (editor.keys.shift_backspace_is_delete true)
    (editor.languages.current )
    (editor.linenumbers false)
    (editor.save_on_verify true)
    (editor.tabs.expand true)
    (editor.tabs.size 2)
    (editor.update_extension true)
    (editor.window.height.default 600)
    (editor.window.height.min 290)
    (editor.window.width.default 500)
    (editor.window.width.min 400)
    (export.applet.separate_jar_files false)
    (export.application.fullscreen false)
    (export.application.platform true)
    (export.application.stop true)
    (export.delete_target_folder true)
    (gui.scale auto)
    (last.ide.1.8.5.daterun 1525296034)
    (last.ide.1.8.5.hardwarepath /Applications/Arduino.app/Contents/Java/hardware)
    (last.screen.height 1080)
    (last.screen.width 1920)
    (last.sketch.count 1)
    (last.sketch.default.location 1278,52,542,711,431,0)
    (last.sketch.default.path /Users/thoughtstem/Dev/RokitRacket/./demo/demo.ino)
    (last.sketch0.location 1278,52,542,711,431,0)
    (last.sketch0.path /Users/thoughtstem/Dev/RokitRacket/./demo/demo.ino)
    (platform.auto_file_type_associations true)
    (preproc.color_datatype true)
    (preproc.enhanced_casting true)
    (preproc.imports.list "java.applet.*,java.awt.Dimension,java.awt.Frame,java.awt.event.MouseEvent,java.awt.event.KeyEvent,java.awt.event.FocusEvent,java.awt.Image,java.io.*,java.net.*,java.text.*,java.util.*,java.util.zip.*,java.util.regex.*")
    (preproc.output_parse_tree false)
    (preproc.save_build_files false)
    (preproc.substitute_floats true)
    (preproc.substitute_unicode true)
    (preproc.web_colors true)
    (programmer arduino:avrispmkii)
    (proxy.manual.hostname )
    (proxy.manual.password )
    (proxy.manual.port )
    (proxy.manual.type HTTP)
    (proxy.manual.username )
    (proxy.pac.url )
    (proxy.type auto)
    (recent.sketches "/Users/thoughtstem/Dev/RokitRacket/./demo/demo.ino,/Users/thoughtstem/Downloads/rokitarduinov1-0-9/sketch_may02a/sketch_may02a.ino")
    (run.display 1)
    (run.options )
    (run.options.memory false)
    (run.options.memory.initial 64)
    (run.options.memory.maximum 256)
    (run.present.bgcolor "#666666")
    (run.present.exclusive true)
    (run.present.stop.color "#cccccc")
    (serial.databits 8)
    (serial.debug_rate 9600)
    (serial.parity N)
    (serial.port ,/dev/serial-port)
    (serial.port.file ,serial-port)
    (serial.port.iserial null)
    (serial.stopbits 1)
    (sketchbook.path ,rokit-path)
    (software ARDUINO)
    (target_package Rokit)
    (target_platform avr)
    (update.check true)
    (update.id -4145554667865659849)
    (upload.using bootloader)
    (upload.verbose false)
    (upload.verify true)))
